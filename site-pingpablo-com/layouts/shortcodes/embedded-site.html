<!-- Hugo shortcode for embedding external sites in an iframe with dynamic height adjustment -->
<iframe 
    id="embedded-{{ .Get "title" | urlize }}"
    title="{{ .Get "title" }}"
    src="{{ .Get "src" }}" 
    style="width: 100%; height: 100%; border: none;" 
    sandbox="allow-scripts allow-same-origin allow-popups allow-popups-to-escape-sandbox allow-forms"
    referrerpolicy="strict-origin-when-cross-origin"
    allowfullscreen="true"
    scrolling="yes"
></iframe>

<script>
// Listen for postMessage events from the embedded iframe
window.addEventListener('message', function(e) {
    // Get the iframe element by its dynamic ID
    const iframe = document.getElementById('embedded-{{ .Get "title" | urlize }}');
    if (!iframe) return;
    
    // Adjust iframe height based on content (adds 70px padding)
    if (e.data.height) iframe.style.height = (e.data.height + 70) + 'px';
    
    // Scroll parent window to specific position within iframe
    if (e.data.scrollTo !== undefined) {
        const iframeTop = iframe.getBoundingClientRect().top + window.pageYOffset;
        window.scrollTo({top: iframeTop + e.data.scrollTo, behavior: 'smooth'});
    }
});
</script>